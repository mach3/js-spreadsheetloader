/*!
 * SpreadSheetLoader
 *
 * @version 0.9
 * @author mach3
 * @require jQuery 1.7+
 */
(function(a,c){var b=function(d){this.setUrl(d||"")};b.prototype={type:"SpreadSheetLoader",EVENT_READY:"ready",url:"",keys:[],data:[],setUrl:function(d){this.url=d.split("?")[0];return this},load:function(){a.ajax({url:this.url,dataType:"jsonp",data:{alt:"json"},success:a.proxy(this._onLoaded,this)});return this},_onLoaded:function(f,d){var e=this;a.each(f.feed.entry,function(j,l){var g,k,n,h;g=l.id.$t.match(/\/R(\d+)C(\d+)$/);k=parseInt(g[1])-2;n=parseInt(g[2])-1;h=l.content.$t;if(k<0){e.keys.push(h)}else{if(n<e.keys.length){e.data[k]=e.data[k]||{};e.data[k][e.keys[n]]=h}}});this.trigger(this.EVENT_READY)},on:function(){a.fn.on.apply(a(this),arguments);return this},trigger:function(){a.fn.trigger.apply(a(this),arguments);return this},getData:function(){return this.data},each:function(d){a.each(this.data,d);return this},getItem:function(e){var d=[];this.each(function(g,h){var f=true;a.each(e,function(i,j){if(h[i]!=j){f=false;return false}});if(f){d.push(h)}});return d}};window.SpreadSheetLoader=b})(jQuery);